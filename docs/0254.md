# é€»è¾‘å›å½’â€“ç®€å•å®ç”¨çš„å®æ–½

> åŸæ–‡:[https://www . ask python . com/python/examples/logistic-regression](https://www.askpython.com/python/examples/logistic-regression)

è¯»è€…æœ‹å‹ä»¬ï¼Œä½ ä»¬å¥½ï¼åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†å…³æ³¨ Python ä¸­é€»è¾‘å›å½’çš„å®é™…å®ç°ã€‚

åœ¨æˆ‘ä»¬ç”¨ Python è¿›è¡Œçš„ä¸€ç³»åˆ—æœºå™¨å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬å·²ç»äº†è§£äº†å„ç§æœ‰ç›‘ç£çš„ ML æ¨¡å‹ï¼Œå¦‚[çº¿æ€§å›å½’](https://www.askpython.com/python/examples/linear-regression-in-python)ã€ [K è¿‘é‚»](https://www.askpython.com/python/examples/knn-in-python)ç­‰ã€‚ä»Šå¤©ï¼Œæˆ‘ä»¬å°†é›†ä¸­è®¨è®ºé€»è¾‘å›å½’ï¼Œå¹¶ç”¨å®ƒæ¥è§£å†³ç°å®ç”Ÿæ´»ä¸­çš„é—®é¢˜ï¼æ¿€åŠ¨å—ï¼Ÿè€¶ï¼ğŸ™‚

è®©æˆ‘ä»¬å¼€å§‹å§ï¼

* * *

## ä¸€ã€ä»€ä¹ˆæ˜¯ Logistic å›å½’ï¼Ÿ

åœ¨å¼€å§‹é€»è¾‘å›å½’ä¹‹å‰ï¼Œè®©æˆ‘ä»¬äº†è§£æˆ‘ä»¬åœ¨å“ªé‡Œéœ€è¦å®ƒã€‚

ä¼—æ‰€å‘¨çŸ¥ï¼Œç›‘ç£æœºå™¨å­¦ä¹ æ¨¡å‹å¯¹è¿ç»­æ•°æ®å€¼å’Œåˆ†ç±»æ•°æ®å€¼éƒ½æœ‰æ•ˆã€‚å…¶ä¸­ï¼Œ[åˆ†ç±»æ•°æ®å€¼](https://www.askpython.com/python/examples/label-encoding)æ˜¯ç»„æˆç»„å’Œç±»åˆ«çš„æ•°æ®å…ƒç´ ã€‚

å› æ­¤ï¼Œå½“æˆ‘ä»¬ä»¥åˆ†ç±»æ•°æ®å˜é‡ä½œä¸ºå› å˜é‡æ—¶ï¼Œè¦åšå‡ºé¢„æµ‹ï¼Œå°±éœ€è¦è¿›è¡Œé€»è¾‘å›å½’ã€‚

**é€»è¾‘å›å½’**æ˜¯ä¸€ä¸ªç›‘ç£æœºå™¨å­¦ä¹ æ¨¡å‹ï¼Œå®ƒä»¥**äºŒå…ƒ**æˆ–**å¤šåˆ†ç±»æ•°æ®å˜é‡**ä¸ºå› å˜é‡ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒæ˜¯ä¸€ä¸ª**åˆ†ç±»ç®—æ³•**ï¼Œå®ƒåˆ†åˆ«åˆ†ç¦»å’Œåˆ†ç±»äºŒè¿›åˆ¶æˆ–å¤šæ ‡è®°å€¼ã€‚

ä¾‹å¦‚ï¼Œå¦‚æœä¸€ä¸ªé—®é¢˜å¸Œæœ›æˆ‘ä»¬é¢„æµ‹ç»“æœä¸ºâ€œæ˜¯â€æˆ–â€œå¦â€ï¼Œé‚£ä¹ˆé€»è¾‘å›å½’å°†å¯¹ç›¸å…³æ•°æ®å˜é‡è¿›è¡Œåˆ†ç±»ï¼Œå¹¶è®¡ç®—å‡ºæ•°æ®çš„ç»“æœã€‚

é€»è¾‘å›å½’ä½¿æˆ‘ä»¬èƒ½å¤Ÿä½¿ç”¨ **logit å‡½æ•°**å¯¹è®­ç»ƒæ•°æ®è¿›è¡Œåˆ†ç±»ï¼Œä»¥ç¬¦åˆå› å˜é‡äºŒå…ƒå˜é‡çš„ç»“æœã€‚æ­¤å¤–ï¼Œlogit å‡½æ•°ä»…ä¾èµ–äº**ä¼˜åŠ¿å€¼å’Œæ¦‚ç‡æœºä¼š**æ¥é¢„æµ‹äºŒå…ƒå“åº”å˜é‡ã€‚

ç°åœ¨è®©æˆ‘ä»¬çœ‹çœ‹é€»è¾‘å›å½’çš„å®ç°ã€‚

* * *

## å®ç”¨æ–¹æ³•-é€»è¾‘å›å½’

åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†åˆ©ç”¨**é“¶è¡Œè´·æ¬¾è¿çº¦è€…é—®é¢˜**,å…¶ä¸­æˆ‘ä»¬é¢„è®¡ä¼šé¢„æµ‹å“ªäº›å®¢æˆ·æ˜¯è´·æ¬¾è¿çº¦è€…ã€‚

åœ¨ è¿™é‡Œå¯ä»¥æ‰¾åˆ°æ•°æ®é›† **[ã€‚](https://github.com/Safa1615/Dataset--loan/blob/main/bank-loan.csv)**

* * *

### 1.åŠ è½½æ•°æ®é›†

åœ¨åˆå§‹æ­¥éª¤ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ [pandas.read_csv()](https://www.askpython.com/python-modules/python-csv-module) å‡½æ•°å°†æ•°æ®é›†åŠ è½½åˆ°ç¯å¢ƒä¸­ã€‚

```
import pandas as pd
import numpy as np
data = pd.read_csv("bank-loan.csv") # dataset

```

### 2.æ•°æ®é›†çš„é‡‡æ ·

åŠ è½½æ•°æ®é›†åï¼Œç°åœ¨è®©æˆ‘ä»¬ä½¿ç”¨ [train_test_split()](https://www.askpython.com/python/examples/split-data-training-and-testing-set) å‡½æ•°å°†æ•°æ®é›†åˆ†ä¸ºè®­ç»ƒæ•°æ®é›†å’Œæµ‹è¯•æ•°æ®é›†ã€‚

```
from sklearn.model_selection import train_test_split 
X = loan.drop(['default'],axis=1) 
Y = loan['default'].astype(str)
X_train, X_test, Y_train, Y_test = train_test_split(X, Y, test_size=.20, random_state=0)

```

è¿™é‡Œï¼ŒX æ˜¯åŒ…å«é™¤äº†å“åº”/ç›®æ ‡å€¼ä¹‹å¤–çš„æ‰€æœ‰å˜é‡çš„è®­ç»ƒæ•°æ®é›†ï¼ŒY æ˜¯æŒ‡ä»…åŒ…å«å“åº”å˜é‡çš„æµ‹è¯•æ•°æ®é›†ã€‚

### 3.å®šä¹‰æ¨¡å‹çš„è¯¯å·®åº¦é‡

ç°åœ¨ï¼Œåœ¨è¿›å…¥æ¨¡å‹æ„å»ºä¹‹å‰ï¼Œè®©æˆ‘ä»¬å®šä¹‰è¯¯å·®åº¦é‡ï¼Œè¿™å°†æœ‰åŠ©äºæˆ‘ä»¬ä»¥æ›´å¥½çš„æ–¹å¼åˆ†ææ¨¡å‹ã€‚

è¿™é‡Œï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª[æ··æ·†çŸ©é˜µ](https://www.askpython.com/python/examples/confusion-matrix)ï¼Œå¹¶è®¡ç®—äº†ç²¾ç¡®åº¦ã€å¬å›ç‡ã€å‡†ç¡®åº¦å’Œ F1 åˆ†æ•°ã€‚

```
def err_metric(CM): 

    TN = CM.iloc[0,0]
    FN = CM.iloc[1,0]
    TP = CM.iloc[1,1]
    FP = CM.iloc[0,1]
    precision =(TP)/(TP+FP)
    accuracy_model  =(TP+TN)/(TP+TN+FP+FN)
    recall_score  =(TP)/(TP+FN)
    specificity_value =(TN)/(TN + FP)

    False_positive_rate =(FP)/(FP+TN)
    False_negative_rate =(FN)/(FN+TP)

    f1_score =2*(( precision * recall_score)/( precision + recall_score))

    print("Precision value of the model: ",precision)
    print("Accuracy of the model: ",accuracy_model)
    print("Recall value of the model: ",recall_score)
    print("Specificity of the model: ",specificity_value)
    print("False Positive rate of the model: ",False_positive_rate)
    print("False Negative rate of the model: ",False_negative_rate)
    print("f1 score of the model: ",f1_score)

```

### 4.å¯¹æ•°æ®é›†åº”ç”¨æ¨¡å‹

ç°åœ¨ç»ˆäºåˆ°äº†å¯¹æ•°æ®é›†æ‰§è¡Œæ¨¡å‹æ„å»ºçš„æ—¶å€™äº†ã€‚çœ‹çœ‹ä¸‹é¢çš„ä»£ç å§ï¼

```
logit= LogisticRegression(class_weight='balanced' , random_state=0).fit(X_train,Y_train)
target = logit.predict(X_test)
CM_logit = pd.crosstab(Y_test,target)
err_metric(CM_logit)

```

**è¯´æ˜:**

*   æœ€åˆï¼Œæˆ‘ä»¬åœ¨è®­ç»ƒæ•°æ®é›†ä¸Šåº”ç”¨äº†`LogisticRegression()`å‡½æ•°ã€‚
*   æ­¤å¤–ï¼Œæˆ‘ä»¬å·²ç»ä½¿ç”¨ [predict()](https://www.askpython.com/python/examples/python-predict-function) å‡½æ•°è¾“å…¥äº†ä¸Šè¿°è¾“å‡ºæ¥é¢„æµ‹æµ‹è¯•æ•°æ®é›†çš„å€¼ã€‚
*   æœ€åï¼Œæˆ‘ä»¬ä½¿ç”¨`crosstab()`åˆ›å»ºäº†ä¸€ä¸ªç›¸å…³çŸ©é˜µï¼Œç„¶åè°ƒç”¨è¯¯å·®åº¦é‡å®šåˆ¶å‡½æ•°(ä¹‹å‰åˆ›å»ºçš„)æ¥åˆ¤æ–­ç»“æœã€‚

**è¾“å‡º:**

```
Precision value of the model:  0.30158730158730157
Accuracy of the model:  0.6382978723404256
Recall value of the model:  0.7307692307692307
Specificity of the model:  0.6173913043478261
False Positive rate of the model:  0.3826086956521739
False Negative rate of the model:  0.2692307692307692
f1 score of the model:  0.42696629213483145

```

å› æ­¤ï¼Œæ­£å¦‚ä¸Šé¢æ‰€è§è¯çš„ï¼Œæˆ‘ä»¬é€šè¿‡æˆ‘ä»¬çš„æ¨¡å‹è·å¾—äº† **63%** çš„å‡†ç¡®æ€§ã€‚

* * *

## ç»“è®º

åˆ°æ­¤ï¼Œæˆ‘ä»¬å°±ç»“æŸäº†è¿™ä¸ªè¯é¢˜ã€‚å¦‚æœä½ é‡åˆ°ä»»ä½•é—®é¢˜ï¼Œæ¬¢è¿åœ¨ä¸‹é¢è¯„è®ºã€‚æ›´å¤šå…³äº Python å’Œ ML çš„æ–‡ç« ï¼Œè¯·ç»§ç»­å…³æ³¨ï¼Œ

å¿«ä¹å­¦ä¹ ï¼ï¼ğŸ™‚